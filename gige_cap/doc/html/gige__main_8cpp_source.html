<html><head><meta http-equiv="Content-Type" content="text/html;charset=utf-8">
<title>gige_cap: gige_main.cpp 源文件</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- 制作者 Doxygen 1.8.11 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>首页</span></a></li>
      <li><a href="pages.html"><span>相关页面</span></a></li>
      <li><a href="modules.html"><span>模块</span></a></li>
      <li><a href="namespaces.html"><span>命名空间</span></a></li>
      <li><a href="annotated.html"><span>类</span></a></li>
      <li class="current"><a href="files.html"><span>文件</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>文件列表</span></a></li>
      <li><a href="globals.html"><span>文件成员</span></a></li>
    </ul>
  </div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">gige_main.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="gige__main_8cpp.html">浏览该文件的文档.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="gige__common_8h.html">gige_common.h</a>&quot;</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="preprocessor">#include &lt;std_msgs/UInt32.h&gt;</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="keyword">using namespace </span><a class="code" href="namespacegige.html">gige</a>;</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="keyword">using</span> std_msgs::UInt32;</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;</div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<a class="code" href="namespacegige.html#a35ba98166e7a2cc829367baf70285690">LoopBody</a> <a class="code" href="group__retryover__group.html#gaac96c4c75b4c19bc2dcdf649a3d5459a">connectRetry</a>(<a class="code" href="structgige_1_1GlobalData.html">GlobalData</a> gd);</div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<a class="code" href="namespacegige.html#a35ba98166e7a2cc829367baf70285690">LoopBody</a> <a class="code" href="group__retryover__group.html#ga05f1d4a20f5544f7207f33d89aa1e489">captureRetry</a>(<a class="code" href="structgige_1_1GlobalData.html">GlobalData</a> gd);</div><div class="line"><a name="l00014"></a><span class="lineno"><a class="line" href="group__retryover__group.html#gaac96c4c75b4c19bc2dcdf649a3d5459a">   14</a></span>&#160;<a class="code" href="namespacegige.html#a35ba98166e7a2cc829367baf70285690">LoopBody</a> <a class="code" href="group__retryover__group.html#gaac96c4c75b4c19bc2dcdf649a3d5459a">connectRetry</a>(<a class="code" href="structgige_1_1GlobalData.html">GlobalData</a> gd)</div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;{</div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacegige.html#a358d0a539400d9cc15b44e725e898eb1">callConnect</a>(gd, <a class="code" href="group__retryover__group.html#ga05f1d4a20f5544f7207f33d89aa1e489">captureRetry</a>, <a class="code" href="group__retryover__group.html#gaac96c4c75b4c19bc2dcdf649a3d5459a">connectRetry</a>);</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;}</div><div class="line"><a name="l00018"></a><span class="lineno"><a class="line" href="group__retryover__group.html#ga05f1d4a20f5544f7207f33d89aa1e489">   18</a></span>&#160;<a class="code" href="namespacegige.html#a35ba98166e7a2cc829367baf70285690">LoopBody</a> <a class="code" href="group__retryover__group.html#ga05f1d4a20f5544f7207f33d89aa1e489">captureRetry</a>(<a class="code" href="structgige_1_1GlobalData.html">GlobalData</a> gd)</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;{</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacegige.html#a309b2a06f663a3d08739170953960592">callCapture</a>(gd, <a class="code" href="group__retryover__group.html#ga05f1d4a20f5544f7207f33d89aa1e489">captureRetry</a>, <a class="code" href="group__retryover__group.html#gaac96c4c75b4c19bc2dcdf649a3d5459a">connectRetry</a>);</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;}</div><div class="line"><a name="l00024"></a><span class="lineno"><a class="line" href="gige__main_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97">   24</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="gige__main_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97">main</a>(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> *argv[])</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;{</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;  ros::init(argc, argv, <a class="code" href="namespacegige.html#aaeffea4748e5cac16b961eb94c42abdb">NODE_NAME</a>);</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;  ros::NodeHandle handle;</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;  Camera camera;</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;  <span class="comment">//发布图像主题</span></div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;  image_transport::ImageTransport transport(handle);</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;  image_transport::Publisher image_pub = transport.advertise(<a class="code" href="namespacegige.html#aa62a1534c321c361202ea378e552d0c2">IMAGE_OUTPUT</a>, 2);</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;  <span class="comment">//发布状态主题</span></div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;  ros::Publisher status_pub = handle.advertise&lt;UInt32&gt;(<a class="code" href="namespacegige.html#a6708bdbb423cd22ac840afba033d9da6">STATUS_OUTPUT</a>, 5);</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;  ros::Rate loop_rate(<a class="code" href="namespacegige.html#a0b3e668ae7bcee11cfa1262964308e09">SPIN_RATE</a>);</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;  <span class="comment">//初始状态 = 未连接</span></div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;  <a class="code" href="namespacegige.html#a35ba98166e7a2cc829367baf70285690">LoopBody</a> run = <a class="code" href="group__retryover__group.html#gaac96c4c75b4c19bc2dcdf649a3d5459a">connectRetry</a>(<a class="code" href="structgige_1_1GlobalData.html">GlobalData</a>(&amp;camera, &amp;image_pub, &amp;status_pub));</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;  <span class="comment">//主循环</span></div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;  <span class="keywordflow">while</span>(ros::ok() &amp;&amp; run != <span class="keyword">nullptr</span>)</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  {</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    run(&amp;run); <span class="comment">//注意run是状态机，执行时会改变其动态绑定</span></div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    ros::spinOnce();</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    loop_rate.sleep();</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  }</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;  <span class="comment">//关闭相机结束</span></div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;  <span class="keywordflow">if</span>(camera.IsConnected())</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;  {</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    camera.StopCapture();</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    camera.Disconnect();</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;  }</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;  <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;}</div><div class="ttc" id="group__retryover__group_html_gaac96c4c75b4c19bc2dcdf649a3d5459a"><div class="ttname"><a href="group__retryover__group.html#gaac96c4c75b4c19bc2dcdf649a3d5459a">connectRetry</a></div><div class="ttdeci">LoopBody connectRetry(GlobalData gd)</div><div class="ttdef"><b>Definition:</b> <a href="gige__main_8cpp_source.html#l00014">gige_main.cpp:14</a></div></div>
<div class="ttc" id="namespacegige_html_a358d0a539400d9cc15b44e725e898eb1"><div class="ttname"><a href="namespacegige.html#a358d0a539400d9cc15b44e725e898eb1">gige::callConnect</a></div><div class="ttdeci">LoopBody callConnect(GlobalData gd, LoopContinuation on_success, LoopContinuation on_failure)</div><div class="ttdoc">连接相机 </div><div class="ttdef"><b>Definition:</b> <a href="gige__connect_8cpp_source.html#l00048">gige_connect.cpp:48</a></div></div>
<div class="ttc" id="namespacegige_html_a309b2a06f663a3d08739170953960592"><div class="ttname"><a href="namespacegige.html#a309b2a06f663a3d08739170953960592">gige::callCapture</a></div><div class="ttdeci">LoopBody callCapture(GlobalData gd, LoopContinuation on_success, LoopContinuation on_failure)</div><div class="ttdoc">捕获相机图像 </div><div class="ttdef"><b>Definition:</b> <a href="gige__capture_8cpp_source.html#l00013">gige_capture.cpp:13</a></div></div>
<div class="ttc" id="gige__main_8cpp_html_a0ddf1224851353fc92bfbff6f499fa97"><div class="ttname"><a href="gige__main_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97">main</a></div><div class="ttdeci">int main(int argc, char *argv[])</div><div class="ttdef"><b>Definition:</b> <a href="gige__main_8cpp_source.html#l00024">gige_main.cpp:24</a></div></div>
<div class="ttc" id="namespacegige_html_a6708bdbb423cd22ac840afba033d9da6"><div class="ttname"><a href="namespacegige.html#a6708bdbb423cd22ac840afba033d9da6">gige::STATUS_OUTPUT</a></div><div class="ttdeci">const char STATUS_OUTPUT[]</div><div class="ttdoc">相机状态输出消息 </div><div class="ttdef"><b>Definition:</b> <a href="gige__config_8h_source.html#l00012">gige_config.h:12</a></div></div>
<div class="ttc" id="structgige_1_1GlobalData_html"><div class="ttname"><a href="structgige_1_1GlobalData.html">gige::GlobalData</a></div><div class="ttdoc">全局公共结构 </div><div class="ttdef"><b>Definition:</b> <a href="gige__common_8h_source.html#l00018">gige_common.h:18</a></div></div>
<div class="ttc" id="namespacegige_html_a35ba98166e7a2cc829367baf70285690"><div class="ttname"><a href="namespacegige.html#a35ba98166e7a2cc829367baf70285690">gige::LoopBody</a></div><div class="ttdeci">std::function&lt; void(void *)&gt; LoopBody</div><div class="ttdoc">主循环的循环体 </div><div class="ttdef"><b>Definition:</b> <a href="gige__common_8h_source.html#l00060">gige_common.h:60</a></div></div>
<div class="ttc" id="group__retryover__group_html_ga05f1d4a20f5544f7207f33d89aa1e489"><div class="ttname"><a href="group__retryover__group.html#ga05f1d4a20f5544f7207f33d89aa1e489">captureRetry</a></div><div class="ttdeci">LoopBody captureRetry(GlobalData gd)</div><div class="ttdef"><b>Definition:</b> <a href="gige__main_8cpp_source.html#l00018">gige_main.cpp:18</a></div></div>
<div class="ttc" id="gige__common_8h_html"><div class="ttname"><a href="gige__common_8h.html">gige_common.h</a></div></div>
<div class="ttc" id="namespacegige_html_aaeffea4748e5cac16b961eb94c42abdb"><div class="ttname"><a href="namespacegige.html#aaeffea4748e5cac16b961eb94c42abdb">gige::NODE_NAME</a></div><div class="ttdeci">const char NODE_NAME[]</div><div class="ttdoc">节点名称 </div><div class="ttdef"><b>Definition:</b> <a href="gige__config_8h_source.html#l00007">gige_config.h:7</a></div></div>
<div class="ttc" id="namespacegige_html"><div class="ttname"><a href="namespacegige.html">gige</a></div><div class="ttdef"><b>Definition:</b> <a href="gige__config_8h_source.html#l00004">gige_config.h:4</a></div></div>
<div class="ttc" id="namespacegige_html_aa62a1534c321c361202ea378e552d0c2"><div class="ttname"><a href="namespacegige.html#aa62a1534c321c361202ea378e552d0c2">gige::IMAGE_OUTPUT</a></div><div class="ttdeci">const char IMAGE_OUTPUT[]</div><div class="ttdoc">图像输出消息 </div><div class="ttdef"><b>Definition:</b> <a href="gige__config_8h_source.html#l00010">gige_config.h:10</a></div></div>
<div class="ttc" id="namespacegige_html_a0b3e668ae7bcee11cfa1262964308e09"><div class="ttname"><a href="namespacegige.html#a0b3e668ae7bcee11cfa1262964308e09">gige::SPIN_RATE</a></div><div class="ttdeci">const int SPIN_RATE</div><div class="ttdoc">spin循环速率 </div><div class="ttdef"><b>Definition:</b> <a href="gige__config_8h_source.html#l00035">gige_config.h:35</a></div></div>
</div><!-- fragment --></div><!-- contents -->

<br clear="all" />
<hr size="1"><div style="align: right;">
<a href="http://wiki.ros.org/gige_cap">gige_cap</a><br />
Author(s): 马鑫宇 <7881999@qq.com></br />
<small>autogenerated on 2016年 七月 21日 星期四 17:26:11</small>
</div>
</body>
</html>
